## ğŸ“Œ **HDB Resale Price Prediction & Model Analysis**
A **machine learning** and **deep learning**-based approach to **predicting HDB resale prices in Singapore** using structured datasets. This project explores **data preprocessing, model training, explainability, and data drift detection** to improve predictive accuracy.

---

## ğŸ“– **Table of Contents**
- [ğŸ“Œ Introduction](#-introduction)
- [ğŸ› ï¸ Methodology](#%EF%B8%8F-methodology)
- [ğŸ“Š Data Preprocessing](#-data-preprocessing)
- [ğŸ§  Model Training & Evaluation](#-model-training--evaluation)
- [ğŸ“ˆ Explainability Analysis](#-explainability-analysis)
- [ğŸš¨ Data Drift Detection](#-data-drift-detection)
- [ğŸ” Findings & Insights](#-findings--insights)
- [ğŸ“ Conclusion](#-conclusion)
- [ğŸ“‚ Repository Structure](#-repository-structure)

---

## ğŸ“Œ **Introduction**
The goal of this project is to **predict resale prices of HDB flats in Singapore** based on key features like **flat size, lease duration, and distance to MRT stations**. 

Additionally, we **analyze feature importance, detect data drift over time, and improve model robustness** by training on different data periods. The project provides an **end-to-end machine learning pipeline**, from **data preprocessing** to **interpretability analysis**.

---

## ğŸ› ï¸ **Methodology**
We follow a structured workflow to **ensure high-quality predictions and explainable AI (XAI):**

1. **Data Preprocessing** â†’ Cleaning, encoding categorical features, and scaling numerical features.
2. **Model Training** â†’ Training a **PyTorch Tabular Model** using different datasets.
3. **Performance Evaluation** â†’ Computing **RÂ² score** and **RMSE** for different training sets.
4. **Explainability Analysis** â†’ Using **Captum** to understand **feature importance**.
5. **Data Drift Detection** â†’ Applying **TabularDrift** to compare **training (â‰¤2019) vs. test (2023)**.

---

## ğŸ“Š **Data Preprocessing**
To ensure high-quality inputs for model training, we perform:

- **Feature Selection** â†’ Dropping irrelevant columns (`full_address`, `nearest_stn`).
- **Categorical Encoding** â†’ Using **label encoding** for categorical features (`town`, `flat_model_type`).
- **Numerical Scaling** â†’ Applying **StandardScaler** to features like `floor_area_sqm` and `remaining_lease_years`.
- **Data Splitting**:
  - **Training Set** (â‰¤2019)
  - **Validation Set** (2020)
  - **Testing Set** (2023)

---

## ğŸ§  **Model Training & Evaluation**
We use **PyTorch Tabular Models** for regression:

### ğŸ”¹ **Different Training Approaches**
| Training Set | Test Set | RÂ² Score | RMSE |
|-------------|---------|---------|----------|
| Year â‰¤ 2020 | 2023 | 0.0792 | 164,759.52 |
| Year â‰¤ 2021 | 2023 | 0.3734 | 135,911.73 |
| 2017 | 2023 | 0.2023 | N/A |

### ğŸ” **Key Observations**
- **Training on older data (â‰¤2020) leads to poor performance on 2023**.
- **Adding 2021 data improves accuracy significantly**.
- **Models trained on 2017 data perform well only for nearby years** but degrade over time.

---

## ğŸ“ˆ **Explainability Analysis**
To interpret the modelâ€™s decisions, we use **Captum** for feature attribution:

### ğŸ”¹ **Feature Importance (Standard Model)**
| Feature | Importance Score |
|---------|----------------|
| **Degree Centrality** | ğŸ”´ High Influence |
| Floor Area (sqm) | ğŸŸ  Moderate Influence |
| Remaining Lease Years | ğŸŸ  Moderate Influence |
| Distance to MRT | ğŸ”µ Low Influence |

ğŸ”¹ **Findings:**
- **Degree Centrality dominates** but is not meaningful for price prediction.
- **Location & lease duration play a significant role** but were underweighted.
- **Standardization improves attribution**, making `floor_area_sqm`, `remaining_lease_years`, and `distance_to_MRT` more prominent.

### ğŸ”¹ **Visualizing Feature Importance**
1. **Heatmaps** â†’ Show which features contribute the most to model decisions.
2. **Violin Plots** â†’ Illustrate **distribution of attribution scores**, helping detect outliers.

---

## ğŸš¨ **Data Drift Detection**
To assess if the model is affected by market shifts, we apply **TabularDrift**.

| Feature | Drift Detected? |
|---------|----------------|
| **Distance to MRT** | ğŸš¨ Yes, Significant Drift |
| **Remaining Lease Years** | ğŸš¨ Yes, Significant Drift |
| **Floor Area (sqm)** | ğŸš¨ Yes, Significant Drift |

### ğŸ”¹ **Key Observations**
- **Location, lease duration, and flat size** have significantly shifted.
- **Older training data (â‰¤2019) does not capture new trends**.
- **A model trained on data closer to 2021 generalizes better**.

---

## ğŸ” **Findings & Insights**
### âœ… **Key Takeaways**
- **Training on recent data (â‰¤2021) improves performance on 2023.**
- **Degree Centrality is over-weighted initially**, but standardization corrects it.
- **Violin plots and heatmaps help identify meaningful feature contributions.**
- **Data drift affects key pricing factors, requiring model retraining over time.**

### ğŸ† **Best Strategy for Prediction**
1. **Train on data closer to the test year (e.g., â‰¤2021 for 2023).**
2. **Standardize numerical features to avoid dominance of irrelevant variables.**
3. **Continuously monitor data drift to detect market shifts.**

---

## ğŸ“ **Conclusion**
This project highlights the importance of **training on recent data**, **explaining model decisions**, and **detecting data drift** to improve resale price prediction accuracy.

By integrating **Captum for explainability** and **TabularDrift for model monitoring**, we ensure that the model remains both **accurate and interpretable**.
